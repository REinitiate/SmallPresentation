<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="news">
		
	<select id="selectGetNewByCnt" resultType="HashMap" parameterType="HashMap">
		select a.gicode gicode, a.itemabbrnm itemabbrnm, a.cnt cnt, b.YIELD yield
		from(
		select a.gicode, b.itemabbrnm, count(*) cnt
		from fnnws_stk_news a, fnlab_j_mast b
		where a.pub_dt between #{t0} and #{t1}
		and a.gicode = b.gicode
		group by gicode
		) a, fnlab_jd b
		where a.gicode = b.gicode
		and b.trd_dt = #{max_dt}
		order by cnt desc;
	</select>
	
	<select id="selectNewDetail" resultType="HashMap" parameterType="HashMap">
		select pub_dt pub_dt, title title, url url, provider provider
		from fnnws_stk_news a
		where a.gicode = #{gicode}
		and a.pub_dt between #{t0} and #{t1}
		order by pub_dt desc;
	</select>
	
</mapper>